<html>

<body>
        <h1>Test</h1>
        <div id="foo"></div>
        <script src="thor-io.client.js">
        </script>
        <script>

                var temp1;

                // to set a new state on the controllers room property, to filter the chatMessage-to
                // call temp1.SetProperty("room","any string");  setting it to "foo" will make the messages appear again

                var showMessage = function(data) {
                        var p = document.createElement("pre");
                        p.innerText = JSON.stringify(data);
                        document.querySelector("#foo").appendChild(p);
                };

                document.addEventListener("DOMContentLoaded", function() {
                        // ws://localhost:1337
                        var client = new ThorIOClient.Factory("wss://thorio.herokuapp.com:443", ["example"], {});
                        client.OnOpen = function(exampleChannel) {
                                temp1 = exampleChannel;
                                exampleChannel.Subscribe("mySub", function(message) {
                                        showMessage(arguments);
                                });
                                exampleChannel.On("history", function(history)
                                {
                                        showMessage({message:"History length " + history.length});
                                        showMessage(history);
                                });
                                exampleChannel.On("chatMessage-one", function() {
                                        showMessage(arguments);
                                });
                                exampleChannel.On("chatMessage-all", function() {
                                        showMessage(arguments);
                                });
                                exampleChannel.On("chatMessage-to", function() {
                                        showMessage(arguments);
                                });
                                exampleChannel.OnOpen = function(ci) {
                                        showMessage(ci);
                                        setInterval(function() {
                                                exampleChannel.Invoke("sendMessage", {
                                                        dt: new Date(),
                                                        txt: "Hello World!"
                                                }, "example");
                                        }, 15000);
                                };
                                exampleChannel.Connect();
                        };
                });
        </script>

</body>

</html>